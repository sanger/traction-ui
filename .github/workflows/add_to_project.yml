name: Add dependencies to technical debt project

on:
  pull_request:
    types:
      - labeled
jobs:
 add-to-project:
    name: Add pull request to project
    runs-on: ubuntu-latest
    steps:
      - uses: actions/add-to-project@v0.5.0
        with:
          project-url: https://github.com/orgs/sanger/projects/12
          github-token: ${{ secrets.ADD_TO_PROJECT_PAT_ORG_WIDE }}
          labeled: depfu

 add-to-project-using-github-app:
    name: Add pull request to project using github app
    runs-on: ubuntu-latest
    steps:
      - name: Get Token
        id: get_workflow_token
        uses: peter-murray/workflow-application-token-action@v3
        with:
          application_id: ${{ vars.PSD_DEMO_APP_ID }}
          application_private_key: ${{ secrets.PSD_DEMO_APP_KEY }}
          permissions: "actions:write"

      - name: Use Application Token to add to project
        uses: actions/add-to-project@v0.5.0
        env:
          GITHUB_TOKEN: ${{ steps.get_workflow_token.outputs.token }}
        with:
          project-url: https://github.com/orgs/sanger/projects/13
          github-token: ${{ secrets.ADD_TO_PROJECT_PAT_ORG_WIDE }}
          labeled: githubapptest